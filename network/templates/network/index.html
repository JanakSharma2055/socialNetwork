{% extends "network/layout.html" %}
{% load static %}

{% block body %}
<div>
    <form action="{% url 'index' %}" method="post">
        {% csrf_token %}
        <div class="form-group" style="margin-bottom: 0">
            <label for="newPost" style="display: none"></label>
            <textarea oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"' class="form-control"
                id="newPost" rows="1" maxlength="280" name="content" placeholder="What's on your mind?"></textarea>
        </div>
        <input class="post-submit btn btn-primary" type="submit" value="Tweet">
    </form>
</div>

<div class="allPosts">
    {% if page_obj %}
    {% for item in page_obj %}
    <div>
        <h1><a href="{% url 'profile' item.user.username %}">{{item.user.username}}</a></h1>
        {% if user == item.user %}
        <button style="float: right; font-size: small; padding: 4px 10px" data-id="{{ item.id }}" class="btn  edit">Edit
        </button>
        {% endif %}
        <p id="likes-{{item.id}}"">{{item.liked_post.count}}</p>
        <p>{{item.post_date}}</p>
        <h2 id="{{item.id}}">{{item.post}}</h2>
        <div style="text-align: center">
            {% if user.is_authenticated %}
            <button data-id="{{ item.id }}" class="btn  like" style="width: 32.65%; display: inline-block">
                {% if item.liked_post.all %}
                    {% for p in item.liked_post.all %}
                        

                        {% if user == p.liked_by%}


                        <div style="color: rgb(32, 120, 244);">
                            <i class="mr-2 fas fa-thumbs-up"></i>Unlike
                        </div>
                        {% elif forloop.last and user != p.liked_by %}
                        <div style="color: rgb(32, 120, 244);">
                            <i class="mr-2 fas fa-thumbs-up"></i>Like
                        </div>
                    


                        {% endif %}
                    {% endfor %}

                {% else %}
                <div style="color: rgb(32, 120, 244);">
                    <i class="mr-2 fas fa-thumbs-up"></i>Like
                </div>

                {% endif %}



            </button>
            {% endif %}
        </div>

    </div>
    <hr>
    {% endfor %}
    {% else %}
    <h1>nothing to show</h1>
    {% endif %}
</div>
{% if page_obj.paginator.num_pages > 1 %}
<nav aria-label="Page navigation">
    <ul class="pagination ml-5 mt-5">
        {% if page_obj.has_previous %}
        <li class="page-item"> <a class="page-link" href="?page=1">First</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">&laquo;</a></li>

        {% endif %}

        <li class="page-item current-item"><span class="current page-link">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            </span></li>


        {% if page_obj.has_next %}
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">&raquo;</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">Last</a>

            {% endif %}
    </ul>
</nav>
{% else %}
<div style="height: 60px"></div>
{% endif %}

{% endblock %}
{% block script %}
<script src="{% static 'network/index.js' %}"></script>


{% endblock %}